# Complete AI-optimized kernel configuration for AMD Zen 5
# For IO Gentoo with NVIDIA RTX 5070 GPU

# Local version
CONFIG_LOCALVERSION="-zen5-ai"
CONFIG_LOCALVERSION_AUTO=n

# Core Architecture - AMD Zen 5 specific
CONFIG_64BIT=y
CONFIG_X86_64=y
CONFIG_CPU_SUP_AMD=y
CONFIG_MZEN5=y
CONFIG_NUMA=y
CONFIG_AMD_NUMA=y
CONFIG_X86_5LEVEL=y
CONFIG_SMP=y
CONFIG_SCHED_SMT=y
CONFIG_SCHED_MC=y

# AMD Platform Support
CONFIG_X86_AMD_PLATFORM_DEVICE=y
CONFIG_X86_MCE_AMD=y
CONFIG_X86_MCE_THRESHOLD=y
CONFIG_AMD_PSTATE=y
CONFIG_X86_AMD_PSTATE_UT=y
CONFIG_X86_AMD_PSTATE_CPB=y
CONFIG_CPU_FREQ_DEFAULT_GOV_SCHEDUTIL=y
CONFIG_CPU_FREQ_GOV_SCHEDUTIL=y

# IOMMU Support
CONFIG_AMD_IOMMU=y
CONFIG_AMD_IOMMU_V2=y
CONFIG_IRQ_REMAP=y

# Security Features
CONFIG_AMD_MEM_ENCRYPT=y
CONFIG_CRYPTO_DEV_SP_PSP=y

# AVX-512 Support (Critical for AI workloads)
CONFIG_X86_AVX512=y
CONFIG_CRYPTO_AVX512=y

# Hugepages and memory tuning
CONFIG_TRANSPARENT_HUGEPAGE=y
CONFIG_TRANSPARENT_HUGEPAGE_ALWAYS=y
CONFIG_HUGETLBFS=y
CONFIG_HUGETLB_PAGE=y
CONFIG_X86_64_1GB_PAGE=y
CONFIG_MEMORY_HOTPLUG=y
CONFIG_MEMORY_HOTREMOVE=y

# CPU Performance (AI workload optimized)
CONFIG_PREEMPT_NONE=y
CONFIG_NO_HZ_FULL=y
CONFIG_RCU_NOCB_CPU=y
CONFIG_RCU_BOOST=y

# Filesystems
CONFIG_BTRFS_FS=y
CONFIG_BTRFS_FS_POSIX_ACL=y
CONFIG_BTRFS_FS_ZSTD=y
CONFIG_BTRFS_FS_REF_VERIFY=y
CONFIG_EXT4_FS=y
CONFIG_VFAT_FS=y
CONFIG_TMPFS=y
CONFIG_TMPFS_POSIX_ACL=y

# Encryption and Crypto
CONFIG_BLK_DEV_DM=y
CONFIG_DM_CRYPT=y
CONFIG_CRYPTO=y
CONFIG_CRYPTO_XTS=y
CONFIG_CRYPTO_AES=y
CONFIG_CRYPTO_SHA256=y
CONFIG_CRYPTO_SHA512=y
CONFIG_CRYPTO_USER_API_SKCIPHER=y
CONFIG_CRYPTO_USER_API_HASH=y
CONFIG_CRYPTO_CRC32C_INTEL=y
CONFIG_CRYPTO_SHA1_SSSE3=y
CONFIG_CRYPTO_SHA256_SSSE3=y
CONFIG_CRYPTO_SHA512_SSSE3=y

# LVM Support
CONFIG_MD=y
CONFIG_BLK_DEV_LVM=y
CONFIG_DM_MIRROR=y
CONFIG_DM_SNAPSHOT=y
CONFIG_DM_THIN_PROVISIONING=y

# NVIDIA GPU support (no Nouveau)
CONFIG_DRM=y
# CONFIG_DRM_NOUVEAU is not set
CONFIG_FB_EFI=y
CONFIG_FB_SIMPLE=y
CONFIG_SYSFB_SIMPLEFB=y
# CONFIG_DRM_SIMPLEDRM is not set
# CONFIG_FB_NVIDIA is not set
# CONFIG_FB_RIVA is not set

# PCIe Support for NVMe
CONFIG_NVME_CORE=y
CONFIG_BLK_DEV_NVME=y
CONFIG_NVME_MULTIPATH=y
CONFIG_NVME_HWMON=y

# AMD Sensors
CONFIG_HWMON=y
CONFIG_SENSORS_K10TEMP=m
CONFIG_SENSORS_NCT6775=m
CONFIG_SENSORS_ASUS_EC=m
CONFIG_SENSORS_ASUS_WMI_EC=m

# Network stack
CONFIG_NET=y
CONFIG_INET=y
CONFIG_IPV6=y
CONFIG_NETFILTER=y
CONFIG_NETFILTER_ADVANCED=y
CONFIG_NF_TABLES=y
CONFIG_NETFILTER_XT_MATCH_CONNTRACK=y
CONFIG_NETLABEL=y
CONFIG_IP_NF_FILTER=y
CONFIG_IP_NF_TARGET_REJECT=y
CONFIG_NETDEVICES=y
CONFIG_VLAN_8021Q=y
CONFIG_BONDING=m
CONFIG_BRIDGE=m
CONFIG_CFG80211=m
CONFIG_MAC80211=m

# High-speed NICs
CONFIG_E1000E=m
CONFIG_IGB=m
CONFIG_IXGBE=m
CONFIG_NET_VENDOR_REALTEK=y
CONFIG_R8169=m
CONFIG_AQTION=m
CONFIG_MLX5_CORE=m

# WireGuard VPN
CONFIG_WIREGUARD=m

# Virtualization & IOMMU
CONFIG_KVM=y
CONFIG_KVM_AMD=y
CONFIG_VFIO=y
CONFIG_VFIO_IOMMU_TYPE1=y
CONFIG_VIRTIO=y
CONFIG_VIRTIO_PCI=y
CONFIG_VIRTIO_NET=y
CONFIG_VIRTIO_BLK=y
CONFIG_VIRTIO_BALLOON=y
CONFIG_VIRTIO_INPUT=y
CONFIG_VIRTIO_CONSOLE=y

# Containers and namespaces
CONFIG_NAMESPACES=y
CONFIG_CGROUPS=y
CONFIG_MEMCG=y
CONFIG_CGROUP_CPUACCT=y
CONFIG_CGROUP_SCHED=y
CONFIG_BLK_CGROUP=y
CONFIG_CGROUP_DEVICE=y
CONFIG_CGROUP_FREEZER=y
CONFIG_CGROUP_PIDS=y
CONFIG_CPUSETS=y
CONFIG_OVERLAY_FS=y
CONFIG_SECCOMP=y
CONFIG_USER_NS=y

# Sound (PipeWire-compatible)
CONFIG_SND=y
CONFIG_SND_PCM=y
CONFIG_SND_HDA_INTEL=m
CONFIG_SND_HDA_CODEC_REALTEK=m
CONFIG_SND_HDA_CODEC_HDMI=m
CONFIG_SND_USB_AUDIO=m
CONFIG_SND_SOC=m

# USB and input
CONFIG_USB_SUPPORT=y
CONFIG_USB_XHCI_HCD=y
CONFIG_USB_EHCI_HCD=y
CONFIG_INPUT_EVDEV=y
CONFIG_INPUT_JOYSTICK=y
CONFIG_HID_GENERIC=y

# Wi-Fi and Bluetooth
CONFIG_WLAN=y
CONFIG_IWLWIFI=m
CONFIG_RT2800PCI=m
CONFIG_BT=m
CONFIG_BT_HCIBTUSB=m

# EFI boot and initramfs
CONFIG_EFI=y
CONFIG_EFI_STUB=y
CONFIG_EFI_MIXED=y
CONFIG_EFI_PARTITION=y
CONFIG_EFIVAR_FS=y
CONFIG_BLK_DEV_INITRD=y
CONFIG_INITRAMFS_SOURCE=""
CONFIG_INITRAMFS_COMPRESSION_ZSTD=y

# Dracut support and modular safety
CONFIG_MODULES=y
CONFIG_MODULE_UNLOAD=y
CONFIG_MODVERSIONS=y

# BPF for networking and tracing
CONFIG_BPF=y
CONFIG_BPF_JIT=y
CONFIG_NET_CLS_BPF=m
CONFIG_NET_ACT_BPF=m

# Remote Processor for AI workloads
CONFIG_REMOTEPROC=y
CONFIG_REMOTE_PROC=y

# x2APIC Support
CONFIG_X86_X2APIC=y

# Performance Events (Platform-agnostic monitoring)
CONFIG_PERF_EVENTS=y
CONFIG_PERF_EVENTS_INTEL_UNCORE=y
CONFIG_PERF_EVENTS_INTEL_RAPL=y
CONFIG_PERF_EVENTS_INTEL_CSTATE=y

# Additional AMD Features
CONFIG_X86_EXTENDED_PLATFORM=y
CONFIG_MICROCODE=y
CONFIG_MICROCODE_AMD=y

# Power Management
CONFIG_ACPI=y
CONFIG_ACPI_PROCESSOR=y
CONFIG_ACPI_CPPC_CPUFREQ=y
CONFIG_X86_ACPI_CPUFREQ=y

# System Recovery & Debugging
CONFIG_MAGIC_SYSRQ=y
CONFIG_IKCONFIG=y

# Production optimizations (debugging disabled)
# CONFIG_DEBUG_KERNEL is not set
# CONFIG_DEBUG_INFO is not set